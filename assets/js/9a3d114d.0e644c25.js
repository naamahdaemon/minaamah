"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5297],{547:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>m,contentTitle:()=>b,default:()=>y,frontMatter:()=>p,metadata:()=>j,toc:()=>k});var n=s(5893),a=s(1151),r=s(7294),o=(s(5742),s(2949)),c=s(2263),i=s(8767),l=s(9669),d=s.n(l);s(938),s(9085),s(9722);const h=new i.QueryClient,u=e=>{let{apiUrl:t,isRelative:s}=e;const[a,l]=(0,r.useState)(t),h=new Date,u=h.getFullYear(),x=h.getMonth(),p=new Date(u,x-1,1).toISOString().split("T")[0],b=new Date(u,x+1,0).toISOString().split("T")[0],[j,m]=(0,r.useState)(p),[k,g]=(0,r.useState)(b),[y,f]=(0,r.useState)(""),[S,T]=(0,r.useState)(""),[B,C]=(0,r.useState)(""),[F,D]=(0,r.useState)(""),[v,P]=(0,r.useState)(""),[q,_]=(0,r.useState)(""),[w,E]=(0,r.useState)("");(0,r.useEffect)((()=>{(async()=>{const{epochData:e,blocksBegin:t,blocksEnd:s}=await W(),{params:n}=await H(e.epoch,t,s);console.log("************************** USE EFFECT PARAM : "+JSON.stringify(n,null,2)+"**************************"),R(e.epoch,n)})()}),[]);const{isDarkTheme:N}=(0,o.I)(),{siteConfig:A}=(0,c.Z)();var I={query:'query{  blocks(sortBy: DATETIME_DESC, query: {creatorAccount: {publicKey: "B62qpsyB3gCndt8sNz4GRwusBtg9U72TNiL4mxmcQfWKZ5noa9fFnWr"}, blockHeight_gt: 335622 blockHeight_lt: 400000, canonical: true}) {    blockHeight    canonical    creator    dateTime    receivedTime    snarkFees    txFees  transactions {coinbase}}}'};const U=async e=>{const t=s?`https://graphql.minaexplorer.com/${a}`:a;try{return(await d().post(t,e,{headers:{"Content-Type":"application/json"}})).data}catch(G){throw new Error(G.message)}},W=async()=>{const{epoch:e,blocksEnd:t}=await(async()=>{const e={query:"query {\n      blocks(sortBy: DATETIME_DESC, limit: 1) {\n        protocolState {\n          consensusState {\n            epoch,\n            blockHeight,\n          }\n        }\n      }\n    }"},t=await U(e),s=t.data.blocks[0].protocolState.consensusState.epoch,n=t.data.blocks[0].protocolState.consensusState.blockHeight;return E(s),{epoch:s,blocksEnd:n}})(),s=e-1;console.log("**************************** getEpoch ****************************");const n={query:`query {\n      blocks(sortBy: DATETIME_DESC, limit: 1, query: {protocolState: {consensusState: {epoch: ${s}}}}) {\n        protocolState {\n          consensusState {\n            epoch\n            epochCount\n            blockHeight\n            slot\n          }\n        }\n      }\n    }`},a=(await U(n)).data.blocks[0].protocolState.consensusState.blockHeight+1,r={epoch:e,begin:a,end:t};return _(r),f(a),T(t),{epochData:r,blocksBegin:a,blocksEnd:t}},H=async function(e,t,s){void 0===e&&(e=q.epoch),void 0===t&&(t=parseInt(y)),void 0===s&&(s=parseInt(S)),console.log("**************************** getBlocks ****************************");const n={query:`query {\n      blocks(sortBy: DATETIME_DESC, query: {\n        creatorAccount: {publicKey: "B62qpsyB3gCndt8sNz4GRwusBtg9U72TNiL4mxmcQfWKZ5noa9fFnWr"},\n        blockHeight_gt: ${t},\n        blockHeight_lt: ${s},\n        canonical: true\n      }) {\n        blockHeight\n        canonical\n        creator\n        dateTime\n        receivedTime\n        snarkFees\n        txFees\n        transactions {\n          coinbase\n          feeTransfer {\n            fee\n            type\n          }          \n        }\n      }\n    }`},a=await U(n);C(a.data.blocks);const r=a.data.blocks.reduce(((e,t)=>e+parseInt(t.transactions.coinbase)),0)/1e9,o=a.data.blocks.reduce(((e,t)=>e+parseInt(t.snarkFees)),0)/1e9,c=a.data.blocks.reduce(((e,t)=>e+parseInt(t.txFees)),0)/1e9,i=a.data.blocks.length,l=a.data.blocks.reduce(((e,t)=>t.transactions&&Array.isArray(t.transactions.feeTransfer)?e+t.transactions.feeTransfer.reduce(((e,t)=>"Fee_transfer_via_coinbase"===t.type?e+parseInt(t.fee):e),0):e),0),d={creatorAccount:a.data.blocks[0].creatorAccount,numberOfBlocks:i,sumCoinbase:r,sumFeeTransferViaCoinbase:l/1e9,sumToBurn:r/2,sumSnarkFees:o,sumTxFees:c};return R(e,d),D(d),{params:d}},R=async function(e,t){void 0===e&&(e=q.epoch),void 0===t&&(t=F);const s=["B62qn9zWo5HcC2RRRi5P8278Hq5RoKgQWqFvXRYxsbVQeDCsAJP7aop","B62qjeFLiBdA94f9AAznCqBUJKNpo5BEYf5hUydp1sXyLwic6RQWMg2","B62qrzDMYjLf2opTM3KSozahGGKkQhVhQmiAfVZ39FZoKa4WGgcdaAq"];console.log("**************************** getDelegations epoch = "+e+" / param = "+JSON.stringify(t,null,2)+"****************************");const n={query:`query {\n      stakes(limit: 1000,query: {\n        delegate: "B62qpsyB3gCndt8sNz4GRwusBtg9U72TNiL4mxmcQfWKZ5noa9fFnWr", \n        epoch: ${e}\n      }) {\n        balance \n        epoch \n        public_key \n        delegationTotals {\n           countDelegates \n           totalDelegated\n          }\n         }\n        }`},a=await U(n),r=a.data.stakes.reduce(((e,t)=>e+t.balance),0),o=a.data.stakes.filter((e=>!s.includes(e.public_key)));console.log("**************************** getDelegations : tout va bien ?****************************");const c=o.reduce(((e,t)=>e+t.balance),0),i=a.data.stakes.map((e=>{if(s.includes(e.public_key)){const s=e.balance/r,n=0;let a=(t.sumCoinbase-t.sumToBurn)*s;return a*=.92,{...e,locked:!0,sharePercentage:s,shareUnlockedPercentage:n,feeShare:0,totalDue:a}}{const s=e.balance/r,n=e.balance/c;let a=(t.sumCoinbase-t.sumToBurn)*s;return a*=.99,a+=t.sumTxFees*n*.99,a-=t.sumSnarkFees*n*.99,{...e,locked:!1,sharePercentage:s,shareUnlockedPercentage:n,feeShare:0,totalDue:a}}}));i.sort(((e,t)=>t.totalDue-e.totalDue)),console.log(JSON.stringify(i,null,2)),P(i)},{isLoading:K,isError:M,data:Q,error:G}=(0,i.useQuery)(["fetchAPI",{selectedApi:a,body:I}],(()=>U(I)),{retry:!1,retryOnMount:!1,refetchOnWindowFocus:!1});if(K)return(0,n.jsx)("div",{children:"Loading..."});if(M)return(0,n.jsxs)("div",{children:["Error: ",G.message]});return(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"B62qpsyB3gCndt8sNz4GRwusBtg9U72TNiL4mxmcQfWKZ5noa9fFnWr"}),(0,n.jsx)("input",{type:"number",placeholder:"Please Wait ...",value:y,onChange:e=>f(e.target.value)}),(0,n.jsx)("input",{type:"number",placeholder:"Please Wait ...",value:S,onChange:e=>T(e.target.value)}),(0,n.jsxs)("button",{onClick:()=>H(q.epoch,y,S),children:["Get Payout Parameter for block ",y," to ",S]}),(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Payout Parameters"}),F?(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Number of block"}),(0,n.jsx)("th",{children:"Total Coinbase"}),(0,n.jsx)("th",{children:"Burnt Amount"}),(0,n.jsx)("th",{children:"Total Snark Fees"}),(0,n.jsx)("th",{children:"Total Coinbase snark fee"}),(0,n.jsx)("th",{children:"Total Tx. Fees"}),(0,n.jsx)("th",{children:"Comm. rate"}),(0,n.jsx)("th",{children:"Foundation rate"})]})}),(0,n.jsx)("tbody",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:F.numberOfBlocks}),(0,n.jsx)("td",{children:F.sumCoinbase}),(0,n.jsx)("td",{children:F.sumToBurn}),(0,n.jsx)("td",{children:F.sumSnarkFees}),(0,n.jsx)("td",{children:F.sumFeeTransferViaCoinbase}),(0,n.jsx)("td",{children:F.sumTxFees}),(0,n.jsx)("td",{children:"1%"}),(0,n.jsx)("td",{children:"8%"})]})})]}):null,(0,n.jsx)("h3",{children:"Delegations"}),v?(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"PK"}),(0,n.jsx)("th",{children:"Balance"}),(0,n.jsx)("th",{children:"locked"}),(0,n.jsx)("th",{children:"Total Share"}),(0,n.jsx)("th",{children:"Unlock Share"}),(0,n.jsx)("th",{children:"Total Due"})]})}),(0,n.jsx)("tbody",{children:v.map(((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.public_key}),(0,n.jsx)("td",{children:e.balance}),(0,n.jsx)("td",{children:e.locked?"Yes":"No"}),(0,n.jsx)("td",{children:e.sharePercentage}),(0,n.jsx)("td",{children:e.shareUnlockedPercentage}),(0,n.jsx)("td",{children:e.totalDue})]},t)))})]}):null,(0,n.jsx)("h3",{children:"Block list"}),B?(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Block Height"}),(0,n.jsx)("th",{children:"Creator"}),(0,n.jsx)("th",{children:"Date Time"}),(0,n.jsx)("th",{children:"Received Time"}),(0,n.jsx)("th",{children:"Snark Fees"}),(0,n.jsx)("th",{children:"Tx Fees"}),(0,n.jsx)("th",{children:"Coinbase"})]})}),(0,n.jsx)("tbody",{children:B.map(((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.blockHeight}),(0,n.jsx)("td",{children:e.creator}),(0,n.jsx)("td",{children:e.dateTime}),(0,n.jsx)("td",{children:e.receivedTime}),(0,n.jsx)("td",{children:e.snarkFees/1e9}),(0,n.jsx)("td",{children:e.txFees/1e9}),(0,n.jsx)("td",{children:e.transactions.coinbase/1e9})]},t)))})]}):null]})]})},x=e=>(0,n.jsx)(i.QueryClientProvider,{client:h,children:(0,n.jsx)(u,{...e})}),p={title:"Payouts",sidebar_label:"Payouts",hide_table_of_contents:!0},b="BP Stats",j={id:"Node Statistics/payouts",title:"Payouts",description:"Payouts Calculator",source:"@site/docs/01-Node Statistics/payouts.md",sourceDirName:"01-Node Statistics",slug:"/Node Statistics/payouts",permalink:"/docs/Node Statistics/payouts",draft:!1,unlisted:!1,editUrl:"https://github.com/naamahdaemon/minaamah/tree/main/docs/01-Node Statistics/payouts.md",tags:[],version:"current",frontMatter:{title:"Payouts",sidebar_label:"Payouts",hide_table_of_contents:!0},sidebar:"mainSidebar",previous:{title:"Delegations",permalink:"/docs/Node Statistics/delegations"},next:{title:"Useful links",permalink:"/docs/General Information/usefull_links"}},m={},k=[{value:"Payouts Calculator",id:"payouts-calculator",level:2}];function g(e){const t={h1:"h1",h2:"h2",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"bp-stats",children:"BP Stats"}),"\n","\n","\n",(0,n.jsx)(t.h2,{id:"payouts-calculator",children:"Payouts Calculator"}),"\n",(0,n.jsx)(x,{apiUrl:"",isRelative:"true"})]})}function y(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(g,{...e})}):g(e)}}}]);