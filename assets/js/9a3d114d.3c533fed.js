"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5297],{547:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>k,contentTitle:()=>b,default:()=>g,frontMatter:()=>x,metadata:()=>j,toc:()=>m});var n=s(5893),a=s(1151),o=s(7294),c=(s(5742),s(2949)),r=s(2263),l=s(8767),i=s(9669),d=s.n(i);s(938),s(9085),s(9722);const h=new l.QueryClient,u=e=>{let{apiUrl:t,isRelative:s}=e;const[a,l]=(0,o.useState)(t),{isDarkTheme:i}=(0,c.I)(),{siteConfig:h}=(0,r.Z)(),[u,p]=(0,o.useState)(""),[x,b]=(0,o.useState)(""),[j,k]=(0,o.useState)(""),[m,y]=(0,o.useState)(""),[g,f]=(0,o.useState)(""),[S,T]=(0,o.useState)(""),[B,C]=(0,o.useState)(""),[v,D]=(0,o.useState)([]);(0,o.useEffect)((()=>{(async()=>{const{epochData:e,blocksBegin:t,finBlock:s,epochs:n}=await P(),{params:a}=await _(e.epoch,t,s);q(e.epoch,a),C(e.epoch),D(n)})()}),[]),(0,o.useEffect)((()=>{(async()=>{if(""!==B){const{epochData:e,blocksBegin:t,finBlock:s,epochs:n}=await P(B),{params:a}=await _(B,t,s);q(B,a)}})()}),[B]);const F=async e=>{const t=s?`https://graphql.minaexplorer.com/${a}`:a;try{return(await d().post(t,e,{headers:{"Content-Type":"application/json"}})).data}catch(n){throw new Error(n.message)}},P=async function(e){void 0===e&&(e=B);const{epoch:t,blocksEnd:s,epochs:n}=await(async()=>{const e={query:"query {\n      blocks(sortBy: DATETIME_DESC, limit: 1) {\n        protocolState {\n          consensusState {\n            epoch,\n            blockHeight,\n          }\n        }\n      }\n    }"},t=await F(e),s=t.data.blocks[0].protocolState.consensusState.epoch,n=t.data.blocks[0].protocolState.consensusState.blockHeight;let a=[];for(let c=0;c<=10;c++){const e=s-c;a.push(e)}const o=a;return D(a),{epoch:s,blocksEnd:n,epochs:o}})();let a,o=s;e?a=e-1:(e=t,a=t-1),console.log("**************************** getEpoch ****************************");const c={query:`query {\n      block1: blocks(sortBy: DATETIME_DESC, limit: 1, query: {protocolState: {consensusState: {epoch: ${a}}}}) {\n        protocolState {\n          consensusState {\n            epoch\n            epochCount\n            blockHeight\n            slot\n          }\n        }\n      }\n      block2: blocks(sortBy: DATETIME_DESC, limit: 1, query: {protocolState: {consensusState: {epoch: ${e}}}}) {\n        protocolState {\n          consensusState {\n            epoch\n            epochCount\n            blockHeight\n            slot\n          }\n        }\n      }\n    }`},r=await F(c),l=r.data.block1[0].protocolState.consensusState.blockHeight+1;o=r.data.block2[0].protocolState.consensusState.blockHeight;const i={epoch:e,begin:l,end:o};return T(i),p(l),b(o),{epochData:i,blocksBegin:l,finBlock:o,epochs:n}},_=async function(e,t,s){void 0===e&&(e=B),void 0===t&&(t=parseInt(u)),void 0===s&&(s=parseInt(x)),console.log("**************************** getBlocks ****************************");const n={query:`query {\n      blocks(sortBy: DATETIME_DESC, query: {\n        creatorAccount: {publicKey: "B62qpsyB3gCndt8sNz4GRwusBtg9U72TNiL4mxmcQfWKZ5noa9fFnWr"},\n        blockHeight_gt: ${t},\n        blockHeight_lt: ${s},\n        canonical: true\n      }) {\n        blockHeight\n        canonical\n        creator\n        dateTime\n        receivedTime\n        snarkFees\n        txFees\n        transactions {\n          coinbase\n          feeTransfer {\n            fee\n            type\n          }          \n        }\n      }\n    }`},a=await F(n);k(a.data.blocks);const o=a.data.blocks.reduce(((e,t)=>e+parseInt(t.transactions.coinbase)),0)/1e9,c=a.data.blocks.reduce(((e,t)=>e+parseInt(t.snarkFees)),0)/1e9,r=a.data.blocks.reduce(((e,t)=>e+parseInt(t.txFees)),0)/1e9,l=a.data.blocks.length,i=a.data.blocks.reduce(((e,t)=>t.transactions&&Array.isArray(t.transactions.feeTransfer)?e+t.transactions.feeTransfer.reduce(((e,t)=>"Fee_transfer_via_coinbase"===t.type?e+parseInt(t.fee):e),0):e),0),d={creatorAccount:a.data.blocks[0].creatorAccount,numberOfBlocks:l,sumCoinbase:o,sumFeeTransferViaCoinbase:i/1e9,sumToBurn:o/2,sumSnarkFees:c,sumTxFees:r};return q(e,d),y(d),{params:d}},q=async function(e,t){void 0===t&&(t=m);const s=["B62qn9zWo5HcC2RRRi5P8278Hq5RoKgQWqFvXRYxsbVQeDCsAJP7aop","B62qjeFLiBdA94f9AAznCqBUJKNpo5BEYf5hUydp1sXyLwic6RQWMg2","B62qrzDMYjLf2opTM3KSozahGGKkQhVhQmiAfVZ39FZoKa4WGgcdaAq"],n={query:`query {\n      stakes(limit: 1000,query: {\n        delegate: "B62qpsyB3gCndt8sNz4GRwusBtg9U72TNiL4mxmcQfWKZ5noa9fFnWr", \n        epoch: ${e}\n      }) {\n        balance \n        epoch \n        public_key \n        delegationTotals {\n           countDelegates \n           totalDelegated\n          }\n         }\n        }`},a=await F(n),o=a.data.stakes.reduce(((e,t)=>e+t.balance),0),c=a.data.stakes.filter((e=>!s.includes(e.public_key)));console.log("**************************** getDelegations : tout va bien ?****************************");const r=c.reduce(((e,t)=>e+t.balance),0),l=a.data.stakes.map((e=>{if(s.includes(e.public_key)){const s=e.balance/o,n=0;let a=(t.sumCoinbase-t.sumToBurn)*s;return a*=.92,{...e,locked:!0,sharePercentage:s,shareUnlockedPercentage:n,feeShare:0,totalDue:a}}{const s=e.balance/o,n=e.balance/r;let a=(t.sumCoinbase-t.sumToBurn)*s;return a*=.99,a+=t.sumTxFees*n*.99,a-=t.sumSnarkFees*n*.99,{...e,locked:!1,sharePercentage:s,shareUnlockedPercentage:n,feeShare:0,totalDue:a}}}));l.sort(((e,t)=>t.totalDue-e.totalDue)),f(l)};return(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"B62qpsyB3gCndt8sNz4GRwusBtg9U72TNiL4mxmcQfWKZ5noa9fFnWr"}),(0,n.jsxs)("select",{value:B,onChange:e=>C(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"Select an Epoch"}),v.map(((e,t)=>(0,n.jsx)("option",{value:e,children:e},t)))]}),(0,n.jsx)("input",{type:"number",placeholder:"Please Wait ...",value:u,onChange:e=>p(e.target.value)}),(0,n.jsx)("input",{type:"number",placeholder:"Please Wait ...",value:x,onChange:e=>b(e.target.value)}),(0,n.jsxs)("button",{onClick:()=>_(S.epoch,u,x),children:["Get Payout Parameter for block ",u," to ",x]}),(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Payout Parameters"}),m?(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Number of block"}),(0,n.jsx)("th",{children:"Total Coinbase"}),(0,n.jsx)("th",{children:"Burnt Amount"}),(0,n.jsx)("th",{children:"Total Snark Fees"}),(0,n.jsx)("th",{children:"Total Coinbase snark fee"}),(0,n.jsx)("th",{children:"Total Tx. Fees"}),(0,n.jsx)("th",{children:"Comm. rate"}),(0,n.jsx)("th",{children:"Foundation rate"})]})}),(0,n.jsx)("tbody",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:m.numberOfBlocks}),(0,n.jsx)("td",{children:m.sumCoinbase}),(0,n.jsx)("td",{children:m.sumToBurn}),(0,n.jsx)("td",{children:m.sumSnarkFees}),(0,n.jsx)("td",{children:m.sumFeeTransferViaCoinbase}),(0,n.jsx)("td",{children:m.sumTxFees}),(0,n.jsx)("td",{children:"1%"}),(0,n.jsx)("td",{children:"8%"})]})})]}):null,(0,n.jsx)("h3",{children:"Delegations"}),g?(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"PK"}),(0,n.jsx)("th",{children:"Balance"}),(0,n.jsx)("th",{children:"locked"}),(0,n.jsx)("th",{children:"Total Share"}),(0,n.jsx)("th",{children:"Unlock Share"}),(0,n.jsx)("th",{children:"Total Due"})]})}),(0,n.jsx)("tbody",{children:g.map(((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.public_key}),(0,n.jsx)("td",{children:e.balance}),(0,n.jsx)("td",{children:e.locked?"Yes":"No"}),(0,n.jsx)("td",{children:e.sharePercentage}),(0,n.jsx)("td",{children:e.shareUnlockedPercentage}),(0,n.jsx)("td",{children:e.totalDue})]},t)))})]}):null,(0,n.jsx)("h3",{children:"Block list"}),j?(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Block Height"}),(0,n.jsx)("th",{children:"Creator"}),(0,n.jsx)("th",{children:"Date Time"}),(0,n.jsx)("th",{children:"Received Time"}),(0,n.jsx)("th",{children:"Snark Fees"}),(0,n.jsx)("th",{children:"Tx Fees"}),(0,n.jsx)("th",{children:"Coinbase"})]})}),(0,n.jsx)("tbody",{children:j.map(((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.blockHeight}),(0,n.jsx)("td",{children:e.creator}),(0,n.jsx)("td",{children:e.dateTime}),(0,n.jsx)("td",{children:e.receivedTime}),(0,n.jsx)("td",{children:e.snarkFees/1e9}),(0,n.jsx)("td",{children:e.txFees/1e9}),(0,n.jsx)("td",{children:e.transactions.coinbase/1e9})]},t)))})]}):null]})]})},p=e=>(0,n.jsx)(l.QueryClientProvider,{client:h,children:(0,n.jsx)(u,{...e})}),x={title:"Payouts",sidebar_label:"Payouts",hide_table_of_contents:!0},b="BP Stats",j={id:"Node Statistics/payouts",title:"Payouts",description:"Payouts Calculator",source:"@site/docs/01-Node Statistics/payouts.md",sourceDirName:"01-Node Statistics",slug:"/Node Statistics/payouts",permalink:"/docs/Node Statistics/payouts",draft:!1,unlisted:!1,editUrl:"https://github.com/naamahdaemon/minaamah/tree/main/docs/01-Node Statistics/payouts.md",tags:[],version:"current",frontMatter:{title:"Payouts",sidebar_label:"Payouts",hide_table_of_contents:!0},sidebar:"mainSidebar",previous:{title:"Delegations",permalink:"/docs/Node Statistics/delegations"},next:{title:"Useful links",permalink:"/docs/General Information/usefull_links"}},k={},m=[{value:"Payouts Calculator",id:"payouts-calculator",level:2}];function y(e){const t={h1:"h1",h2:"h2",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"bp-stats",children:"BP Stats"}),"\n","\n","\n",(0,n.jsx)(t.h2,{id:"payouts-calculator",children:"Payouts Calculator"}),"\n",(0,n.jsx)(p,{apiUrl:"",isRelative:"true"})]})}function g(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(y,{...e})}):y(e)}}}]);